(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{167:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("之前公司决定开发一款小程序。")]),t._v(" "),a("p",[t._v("我接触微信小程序也就一两个月的时间，没使用过小程序官方的开发语言，而是直接使用 mpvue 上手了，自己开发了一个因为内容的原因无法上架的 DEMO。正好也被推上了前端部门的 leader，所以也就接下了这个任务。")]),t._v(" "),a("p",[t._v("使用 mpvue 的因为本以为由 Vue 转小程序用 mpvue 会方便，不过没想到坑挺多的，一般的 Web 开发者如果以 Vue 的思维入手会遇到很多麻烦，因为小程序的运行环境和浏览器完全不同。")]),t._v(" "),a("p",[t._v("另外京东凹凸实验室的 Taro 也是一个非常好的框架，不过我没有去深入研究它。考虑到公司技术栈转 Vue 的要求，我们团队选择了 mpvue，然而我个人认为 mpvue 还是个不太成熟的框架，文档不完善，在开发编译时也容易出 bug，另外就是分包加载的支持比较慢，好在最近出了新版本的 mpvue-loader。但是新版本的 mpvue-loader 完全更改了 app.json/main.json 文件的写法，文档中也没有明确提到，只能通过新的 quickstart 来了解新的写法。")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),a("p",[t._v("weui 是腾讯开发的 css 框架，可以用于编写腾讯规范的小程序控件。")]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("p",[t._v("微信支付需要小程序上线之后在微信公众平台中申请开通。")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=7_7&index=3",target:"_blank",rel:"noopener noreferrer"}},[t._v("【微信支付】微信小程序支付开发者文档"),a("OutboundLink")],1)]),t._v(" "),a("ol",[a("li",[t._v("获取 openid")]),t._v(" "),t._m(8),t._v(" "),a("li",[a("code",[t._v("wx.requestPayment()")]),t._v(" 发起支付请求，参数见"),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/api-pay.html#wxrequestpaymentobject",target:"_blank",rel:"noopener noreferrer"}},[t._v("微信支付 · 小程序"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("如果在手机上操作会直接弹出微信支付相关弹窗，在开发者工具中操作则会生成二维码，扫描即可；在手机上可以直接弹出微信支付的弹窗。")]),t._v(" "),t._m(9)]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),a("p",[t._v("我们可以在官方的 quickstart 模板的基础上进行开发【"),a("a",{attrs:{href:"http://mpvue.com/mpvue/quickstart/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Quickstart - mpvue-docs"),a("OutboundLink")],1),t._v("】。")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),a("p",[t._v("主包最大为 2MB，各个分包大小最大为 8MB。在较大型的小程序开发时，最好是将各个模块独立出来，尽可能只保留入口页面和 Tab 标签页对应的页面在主包中。")]),t._v(" "),a("p",[t._v("分包加载只有在 mpvue-loader@1.1.x 版本才支持。")]),t._v(" "),a("p",[t._v("会打包到主包的内容（包括但不限于如下内容）：")]),t._v(" "),t._m(14),t._v(" "),a("p",[t._v("注意：千万不要因为某个功能用某个 package 做很方便，就安装并引入它，因为这些 package 全部会打包到主包的 vender.js 中！这样很容易造成主包大小过大！")]),t._v(" "),a("p",[t._v("如果一个 package 是你不得不引入的核心 package（例如 vue, vuex, node-sass, sass-loader 等），那么就将它引入。")]),t._v(" "),a("p",[t._v("如果一个 package 你只使用到它的 1% 的功能（或者有非常多的功能用不上），请不要引入！例如安装了 qs, moment 和 lodash 之后，在我们公司的项目中，打包后的 vender.js 最大可以达到 1.6MB，而在移除它们所有的引用之后只有 462 KB。")]),t._v(" "),a("p",[t._v("JS 的大型工具库（如 lodash）千万不要引入 mpvue，因为它们大部分都可以简单地用原生 JS 实现。")]),t._v(" "),a("p",[t._v("占用空间的静态图片尽可能使用在线资源。导航栏图标和各种 icon，为了用户体验，建议放在本地。")]),t._v(" "),t._m(15),t._v(" "),a("p",[t._v("由于性能的限制，小程序页面栈中最多只能存在5个页面，也就是最多只能转跳 5 层。  此时就需要善用清空页面栈的方法，例如转跳的时候使用 redirectTo / relaunch 等方法。但是在页面栈被清空之后，小程序右上角的返回按钮就会消失，所以在产品设计时处理好转跳逻辑是很关键的。详情见小程序文档："),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/ui-navigate.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("导航 · 小程序API"),a("OutboundLink")],1),t._v("，"),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/navigator.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("导航 · 小程序组件"),a("OutboundLink")],1)]),t._v(" "),t._m(16),t._v(" "),a("p",[t._v("小程序页面间的传值靠的是路由的 params，类似于 vue-router 中的 params。在新页面中，若要接收值，则需要在 onLoad 生命周期中接收，onLoad 方法的第一个参数即为传入的 params 对象。")]),t._v(" "),a("p",[t._v("注意：params 传值默认的数据类型是 String。")]),t._v(" "),t._m(17),t._v(" "),a("p",[t._v("小程序在点击左上角返回的时候不能自动清空当前页面的数据，如果需要清空数据，我们需要手动在 onUnload 的生命周期钩子里将 Vue 的 data 中的所有数据还原成初始状态。")]),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),a("p",[t._v("不建议/不应该使用其他可以带参数的导航方式，因为它们会破坏现有的页面栈或者导致页面栈混乱，除非有特殊的需求。")]),t._v(" "),t._m(20),t._v(" "),a("p",[t._v("小程序有自己一套生命周期，和 Vue 的生命周期不冲突，但是行为有所区别。")]),t._v(" "),a("p",[t._v("举例来说，一个页面加载时，这些生命周期钩子会按如下顺序被调用：onLoad, onShow, mounted。页面存在页面栈中时，如果返回该页面，不会触发 onLoad 和 mounted，但是会触发 onShow，因为这个页面已经被挂载了。\n更多小程序生命周期的详情请看小程序的官方开发文档。")]),t._v(" "),t._m(21),t._v(" "),a("p",[t._v("小程序中发起网络请求可以使用 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/network-request.html#wxrequestobject",target:"_blank",rel:"noopener noreferrer"}},[t._v("wx.request()"),a("OutboundLink")],1),t._v("，也可以使用 "),a("a",{attrs:{href:"https://www.npmjs.com/package/flyio",target:"_blank",rel:"noopener noreferrer"}},[t._v("fly.io"),a("OutboundLink")],1),t._v("，一个类似 axios 的开源库。")]),t._v(" "),t._m(22),t._v(" "),a("p",[t._v("在 Web 中我们有 session 和 WebStorage 可以存储一些公用数据如 token。而小程序有自己的本地缓存："),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/data.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("数据缓存 · 小程序"),a("OutboundLink")],1),t._v("，用法和 WebStorage 相似，但是有同步和异步方法的区别。")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),a("p",[t._v("微信的授权弹窗在目前版本中无法主动触发，需要用 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/button.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("button 的 open-type 属性"),a("OutboundLink")],1),t._v(" 获取授权。授权弹窗只能获取微信的用户信息。授权弹窗中有 encryptedData 和 iv，这两个数据很关键，可以让服务端解码出 unionId。unionId 是用户唯一标识，在第三方登录授权中需要使用到。")]),t._v(" "),a("p",[t._v("如果需要微信开发者平台的第三方登录，需要使用 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/api-login.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("wx.login()"),a("OutboundLink")],1),t._v(" 的方法获取 code，并发送给服务端处理，通过 code 可以获取 sessionKey 和 openid。")]),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),a("p",[t._v("分页加载有两种方式: onReachBottom 和 scroll-view")]),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),a("p",[t._v("小程序中的 image 如果不手动设置大小，会默认被设置为 320*240 (rpx)。小程序中 image 的自适应和 Web 开发并不一样，使用的是 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/image.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("image 的 mode 属性"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("小程序的 image 不支持 svg 的图片，需要用 css 的 background-image。")]),t._v(" "),a("p",[t._v("app.json 中，TabBar 的 icon 不能用 svg。")]),t._v(" "),a("p",[t._v("在 mpvue 中可以使用 iconfont。")]),t._v(" "),t._m(31),t._v(" "),a("p",[t._v("按照从移动 H5 转过来的思维，1像素边框一般需要用伪元素来写。小程序中同样可以使用 ::after 伪元素写1像素的边框，但是实际的显示出来的位置都和 Web 有区别。可以参考 "),a("a",{attrs:{href:"http://kuangpf.com/mpvue-weui/#/README",target:"_blank",rel:"noopener noreferrer"}},[t._v("mpvue-weui"),a("OutboundLink")],1),t._v(" 的 weui.css 中的方式进行开发。")]),t._v(" "),a("p",[t._v("但事实上，微信小程序的 rpx 就是自适应单位，相当于移动 H5 做自适应常用的 rem。1rpx = 0.5px = 1 物理像素。所以我们实际上可以使用 rpx 来写 1 像素边框。当然微信小程序也支持 rem，规定屏幕宽度为20rem，所以 1rem = (屏幕宽度 / 20)rpx。")]),t._v(" "),a("p",[t._v("button 在有 border-radius 的时候可能边框显示不全，此时建议用 div 包裹 button 并在 div 上写 1px 的 border，隐藏 button 自带的 border。")]),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),a("p",[t._v("在项目中，服务端只会给出所有的城市列表，之后我们需要在本地对其进行分类。按字母分类使用了 "),a("a",{attrs:{href:"https://github.com/hotoo/pinyin",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub - hotoo/pinyin: 汉字拼音 ➜ hàn zì pīn yīn"),a("OutboundLink")],1),t._v(" 。")]),t._v(" "),a("p",[t._v("页面分为侧边字母导航条和城市列表。项目的需求是只需要列出满足条件的部分城市，所以导航字母也需要根据城市动态显示。")]),t._v(" "),a("p",[t._v("点击字母滚动到对应位置的功能使用了 scroll-view 的 scroll-into-view，在 scroll-into-view 上动态绑定对应字母的唯一 id（变量在 Vue 的 data 中），同时在我们渲染城市的时候，需要在最外层加上属性 id，与 scroll-into-view 上的 id 要对应。")]),t._v(" "),t._m(37),t._v(" "),t._m(38),t._m(39)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"mpvue-小程序开发踩坑记"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mpvue-小程序开发踩坑记","aria-hidden":"true"}},[this._v("#")]),this._v(" mpvue 小程序开发踩坑记")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"我对小程序和-mpvue-的理解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#我对小程序和-mpvue-的理解","aria-hidden":"true"}},[this._v("#")]),this._v(" 我对小程序和 mpvue 的理解")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"mpvue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mpvue","aria-hidden":"true"}},[this._v("#")]),this._v(" mpvue")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("mpvue 是美团开发的，允许开发者使用 Vue 语法来编写小程序的框架。")]),this._v(" "),s("li",[this._v("小程序本质上类似于 Web 的多页应用，不同之处是它依靠微信 App 内的 JavaScript 引擎和 WXML/WXSS 引擎进行渲染，所以与 Web 端相比，小程序里不存在 DOM，无法使用原生 DOM 的操作，也不存在浏览器的各种 API。")]),this._v(" "),s("li",[this._v("在使用 mpvue 时，实际上可以看作是用 Vue 构建多页 Web App。")]),this._v(" "),s("li",[this._v("在 Webpack 打包时，Vue Web App 是最终打包成 index.html 以及 css 和 js 文件各 1 个（如果你不开 source map 的话）。而 mpvue-loader 是将 Vue 语法转换成小程序原生语法的 Webpack loader，打包后的文件实际上就是原生小程序的语法（js 除外），这样就可以在小程序开发工具中预览和 debug。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"weui"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#weui","aria-hidden":"true"}},[this._v("#")]),this._v(" weui")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"小程序开发工具-微信公众平台-小程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小程序开发工具-微信公众平台-小程序","aria-hidden":"true"}},[this._v("#")]),this._v(" 小程序开发工具/微信公众平台 - 小程序")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("小程序开发工具是用于本地 debug 的工具，使用了 Chrome Devtools，并可以进行真机调试以及发布体验版\n"),a("ul",[a("li",[t._v("真机调试：使用小程序上的“远程调试”按钮即可调试，在开发者的微信中的小程序列表中显示为“开发版”")]),t._v(" "),a("li",[t._v("体验版：使用小程序上的“上传”按钮即可发布体验版，开发者和体验者扫码后可以访问，在开发者和体验者的微信中的小程序列表中显示为“体验版”")])])]),t._v(" "),a("li",[t._v("微信公众平台 - 小程序 是小程序项目的管理后台\n"),a("ul",[a("li",[t._v("小程序和公众号是两个独立的账号，可以相互关联")]),t._v(" "),a("li",[t._v("如果要团队协作开发，必须要在微信公众平台上添加开发者和体验者")]),t._v(" "),a("li",[t._v("若需要使用网络请求，必须在微信公众平台上添加 https 的服务器")]),t._v(" "),a("li",[t._v("https 服务器的 URL 可以是二级、三级...域名，但不能带相对路径，例如可以是 api.test.example.cn 或者 api.example.cn，但不能使用 api.example.com/v1")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"微信支付"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微信支付","aria-hidden":"true"}},[this._v("#")]),this._v(" 微信支付")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("请求支付接口获取 "),s("code",[this._v("wx.requestPayment()")]),this._v(" 所需参数")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("li",[t._v("支付完成后使用 "),a("code",[t._v("wx.reLaunch")]),t._v(" 转跳到结果页面，但是使用 "),a("code",[t._v("wx.reLaunch")]),t._v(" 时，在 Android 上会提示 reLaunch:fail can not invoke reLaunch in background，此时只需加一个 setTimeout 即可。因为调用微信支付的窗口时，实际上会先把当前的 page 隐藏，如果在体验版里打开调试模式可以看到页面先 onHide 再 onShow，而我们需要在支付成功后转跳，所以 "),a("code",[t._v("wx.reLaunch")]),t._v(" 是放在 "),a("code",[t._v("wx.requestPayment()")]),t._v(" 的回调中执行的，此时页面仍没有 onShow，而 "),a("code",[t._v("wx.reLaunch")]),t._v(" 需要在 onShow 之后才能调用。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"mpvue-小程序开发中需要注意的点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mpvue-小程序开发中需要注意的点","aria-hidden":"true"}},[this._v("#")]),this._v(" mpvue 小程序开发中需要注意的点")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"mpvue-的项目结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mpvue-的项目结构","aria-hidden":"true"}},[this._v("#")]),this._v(" mpvue 的项目结构")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("static - 静态文件")]),t._v(" "),a("li",[t._v("src\n"),a("ul",[a("li",[t._v("pages\n"),a("ul",[a("li",[t._v("A - 页面A\n"),a("ul",[a("li",[t._v("A.vue - .vue 页面")]),t._v(" "),a("li",[t._v("main.js - Vue 的 js 文件，用于挂载页面")]),t._v(" "),a("li",[t._v("main.json - 小程序的页面配置文件")])])])])]),t._v(" "),a("li",[t._v("components - 公用组件")]),t._v(" "),a("li",[t._v("utils - 工具")]),t._v(" "),a("li",[t._v("app.json - 小程序的 app.json 主文件")]),t._v(" "),a("li",[t._v("App.vue - 小程序主入口")]),t._v(" "),a("li",[t._v("main.js - 类似 Vue 的 main.js，加载全局内容，挂载 Vue 实例")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"小程序有包大小的限制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小程序有包大小的限制","aria-hidden":"true"}},[this._v("#")]),this._v(" 小程序有包大小的限制")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[t._v("放在 app.json 中的 pages 中的页面")]),t._v(" "),a("li",[t._v("静态文件，如图片")]),t._v(" "),a("li",[t._v("公用组件")]),t._v(" "),a("li",[t._v("vuex")]),t._v(" "),a("li",[t._v("utils")]),t._v(" "),a("li",[t._v("安装的各种有被引用的 package")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"小程序有页面栈的限制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小程序有页面栈的限制","aria-hidden":"true"}},[this._v("#")]),this._v(" 小程序有页面栈的限制")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"小程序页面间传值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小程序页面间传值","aria-hidden":"true"}},[this._v("#")]),this._v(" 小程序页面间传值")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"返回时清空数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回时清空数据","aria-hidden":"true"}},[this._v("#")]),this._v(" 返回时清空数据")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"返回上一页（上x页）时携带参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回上一页（上x页）时携带参数","aria-hidden":"true"}},[this._v("#")]),this._v(" 返回上一页（上X页）时携带参数")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("我们在返回时会使用 "),s("code",[this._v("wx.navigateBack()")]),this._v("，这个方法不可携带参数。所以我们需要用小程序内置的 Storage 或者 Vuex 进行数据存取的操作。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"小程序的生命周期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小程序的生命周期","aria-hidden":"true"}},[this._v("#")]),this._v(" 小程序的生命周期")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"网络请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#网络请求","aria-hidden":"true"}},[this._v("#")]),this._v(" 网络请求")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"小程序的数据存储"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小程序的数据存储","aria-hidden":"true"}},[this._v("#")]),this._v(" 小程序的数据存储")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在 mpvue 中我们同样可以使用 vuex，但是需要注意的是我们无法像 Web 开发时一样在 "),s("code",[this._v("new Vue()")]),this._v(" 的时候传入 vuex 作为参数，而是需要手动挂载到 Vue.prototype 上。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"登录与授权"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#登录与授权","aria-hidden":"true"}},[this._v("#")]),this._v(" 登录与授权")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("wx.login()")]),this._v(" 一定要在授权弹窗之前调用，因为解密 encryptedData 和 iv 需要 sessionKey，sessionKey 是从 code 获得的。在 "),s("code",[this._v("wx.login()")]),this._v(" 得到的 code（以及 code 获取的 sessionKey） 之后获取的 encryptedData 和 iv 是一一对应的，若颠倒顺序，则 encryptedData 和 iv 无法和 sessionKey 对应上。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#标签","aria-hidden":"true"}},[this._v("#")]),this._v(" 标签")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("mpvue 中可以使用 Web 的标签，最后会被编译成对应的小程序标签；也可以使用小程序的原生标签。小程序的原生标签可以帮助我们做很多 Web 标签无法实现的工作，例如 swiper 和 swiper-item 可以实现左滑右滑切换 Tab 页；scroll-view 实际上是一个 "),s("code",[this._v("overflow-(x/y): auto;")]),this._v(" 的块级元素，并且本身不带滚动条，但是注意 scroll-view 并不会触发 onReachBottom 的钩子。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"分页加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分页加载","aria-hidden":"true"}},[this._v("#")]),this._v(" 分页加载")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("使用 onReachBottom 时不能使用 scroll-view，只能使用普通的 view / div。scroll-view 使用 @scrolltolower (原生小程序是 bindscrolltolower) 的 event。")]),t._v(" "),a("li",[t._v("包裹着列表组件的容器必须保证能滚动到屏幕底部，也就是说 CSS 里对高度的设置需要注意")]),t._v(" "),a("li",[t._v("页面_组件中需要有变量记录当前页码或者下一页的页码，在触发 onReachBottom_@scrolltolower 时使用这个页码去获取新的分页数据")]),t._v(" "),a("li",[t._v("分页加载完成后，数据需要加到原列表数组的最后")]),t._v(" "),a("li",[t._v("页面_组件中需要有变量记录总页数，在 onReachBottom_@scrolltolower 时，如果已经到最后一页则不继续加载或者弹出提示")]),t._v(" "),a("li",[t._v("在进行一些复杂操作的时候记得清空当前页码和总页数，防止数据混乱")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"图片"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片","aria-hidden":"true"}},[this._v("#")]),this._v(" 图片")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"长度单位与-1-像素边框"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#长度单位与-1-像素边框","aria-hidden":"true"}},[this._v("#")]),this._v(" 长度单位与 1 像素边框")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"position-fixed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#position-fixed","aria-hidden":"true"}},[this._v("#")]),this._v(" position: fixed")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("小程序的 position: fixed 和 Web 上的表现有所不同。如果 mpvue 小程序的页面中有其他 Vue 组件，那么在组件中设定的 "),s("code",[this._v("position: fixed")]),this._v(" 只会相对于这个组件是 fixed，并不会在页面中 fixed。如果设定 "),s("code",[this._v("bottom: 0")]),this._v("，那么它只会固定在 Vue 组件的底部，而不是整个页面的底部。也就是说，mpvue 小程序中的 Vue 组件实际上是一个 BFC。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("mpvue 中同样有事件，但是调取参数 e 的值的方式和 Web 不同，需要使用 "),s("code",[this._v("e.mp.detail")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"点击导航条转跳到相应位置（类似通讯录）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#点击导航条转跳到相应位置（类似通讯录）","aria-hidden":"true"}},[this._v("#")]),this._v(" 点击导航条转跳到相应位置（类似通讯录）")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("字母导航条中，我们需要设定一个 data-i，并在 click 事件中用 "),s("code",[this._v("e.currentTarget.dataset.i")]),this._v(" 获取这个 data-i，并赋值给 data 中绑定 id 的变量，这样就可以直接转跳到相应的位置。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("city"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("city__body"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("current-city"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("当前定位城市：{{ city.city }}"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("scroll-view")]),t._v(" \n        "),a("span",{attrs:{class:"token attr-name"}},[t._v("scroll-y")]),t._v("\n        "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("alphabet"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n        "),a("span",{attrs:{class:"token attr-name"}},[t._v(":scroll-into-view")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("'")]),t._v("id-"),a("span",{attrs:{class:"token punctuation"}},[t._v("'")]),t._v(" + toView"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v(":id")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("'")]),t._v("id-"),a("span",{attrs:{class:"token punctuation"}},[t._v("'")]),t._v(" + index"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(item, index) in filteredCities"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v(":key")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("item.firstLetter + index"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("weui-cells__title"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{ item.firstLetter }}"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("weui-cells weui-cells_after-title"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("weui-cell"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(_item, _index) in item.cities"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v(":key")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("_item.cityCode + _index"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("@click")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("setCity(_item)"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n              "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("weui-cell__bd"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{ _item.city }}"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("scroll-view")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("city__letters"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(item, index) in nav"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v(":key")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("item"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("@click")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v("'")]),t._v("setAlphabet"),a("span",{attrs:{class:"token punctuation"}},[t._v("'")])]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v(":data-i")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("index"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{item}}"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token function"}},[t._v("data")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      nav"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v("'A'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'B'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'C'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'D'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'E'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'F'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'G'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'H'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'I'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'J'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'K'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'L'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'M'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'N'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'O'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'P'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'Q'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'R'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'S'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'T'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'U'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'V'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'W'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'X'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'Y'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'Z'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      toView"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      cities"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{attrs:{class:"token function"}},[t._v("onLoad")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t  "),a("span",{attrs:{class:"token comment"}},[t._v("// 获取城市")]),t._v("\n\t  "),a("span",{attrs:{class:"token function"}},[t._v("getCity")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token comment"}},[t._v("/* 调用成功 */")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" categoriedCities "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cities "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" nav "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" item "),a("span",{attrs:{class:"token keyword"}},[t._v("of")]),t._v(" res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{attrs:{class:"token comment"}},[t._v("// 提取城市首字母，放入导航列表")]),t._v("\n          "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" py "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("pinyin")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("city"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" style"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pinyin"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token constant"}},[t._v("STYLE_FIRST_LETTER")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" firstLetter "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" py"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("toUpperCase")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("firstLetter"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            nav"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("push")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("firstLetter"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),a("span",{attrs:{class:"token comment"}},[t._v("// 构造新的数据，加入首字母")]),t._v("\n          "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newItem "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("item"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            firstLetter"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            city"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" item"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("city"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("substring")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" item"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("city"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          cities"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("push")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newItem"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 导航里去除重复的字母")]),t._v("\n        nav "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token operator"}},[t._v("...")]),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nav"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 根据导航的字母，把上面构造的数据按照字母进行重新分类，得到最后需要的结果")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 对每个字母，在上面构造的数据中筛选出相应字母的所有城市，放入一个对象中并 push 入最终数组")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" item "),a("span",{attrs:{class:"token keyword"}},[t._v("of")]),t._v(" nav"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" sameLetterCities "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cities"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("filter")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" i"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("firstLetter "),a("span",{attrs:{class:"token operator"}},[t._v("===")]),t._v(" item"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          categoriedCities"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("push")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            firstLetter"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" item"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            cities"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sameLetterCities\n          "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nav "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" nav\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cities "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" categoriedCities\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token operator"}},[t._v("<")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])}],!1,null,null,null);e.options.__file="mpvue-wx-mini-app-first-look.md";s.default=e.exports}}]);